for i in vertex_points_BM
        for j in neighbours_BM[i,:]
            if j != 0.0
                j=convert(Int64, j)
                r .= BM_pos[j,:] .- BM_pos[i,:]
                r_mag = sqrt(dot(r,r))
                if r_mag > 15*s_BM
                    N_BM_cells = N_BM_cells + 1
                    #in each timestep, the positions are given and look to be correct
                    #however, in the next timestep, the positions calculated in the previous timestep are forgotten and replaced with NaN
                    BM_pos[N_BM_cells, :] .= 0.5*(BM_pos[j,:] + BM_pos[i,:])

                    print("NEW CELL, i=", i, "j=",j, "mag=", r_mag, "POS OF NEW BM CELL=", BM_pos[N_BM_cells,:], "\n")
                else
                    print("NO i=", i, "j=",j,"mag=", r_mag, "\n")
                end
            end
        end
    end


t1: initialise with 5 positions
##This matrix is printed out in the main file
BM pos = [-1.4513964381417157 1.9937368447031023 2.173369052183851;
 0.6308805185710518 0.9859641468264013 2.958794252315018;
 1.6739452431324393 -2.1227386130964936 -1.9278092601472325;
 -1.210951739036782 1.1410216378375395 -2.489796525039097; 
1.313292290672253 0.9403216416692777 1.8044177773650025;
 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0
0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0
0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0]

t1: calculate new positions and add them in to the zero rows
keep track of which row to fill using N_BM_cells, and increment by 1 each time a cell is added
BM pos = [-1.4091995006340143 1.9592014211206235 2.084037894254317; 
0.6330240401199159 0.9705119053699037 2.939176639161262;
 1.6669214446572342 -2.121446196410933 -1.8920154886412428;
 -1.2094293396297429 1.1371764921791871 -2.473225669099244;
 1.318260558117489 0.9479013350251406 1.7807732908674854; ----> original elements
 0.12886097201160995 -0.08112238764515478 0.09601120280653719;
 -1.3093144201318787 1.5481889566499052 -0.1945938874224633;
1.149972742388575 -0.5754671455205147 0.5235805752600096;
 1.149972742388575 -0.5754671455205147 0.5235805752600096; 
0.12886097201160995 -0.08112238764515478 0.09601120280653719;
 0.2287460525137457 -0.49213485211587293 -2.1826205788702433; 
1.4925910013873618 -0.5867724306928962 -0.05562109888687872;
 0.2287460525137457 -0.49213485211587293 -2.1826205788702433; 
-1.3093144201318787 1.5481889566499052 -0.1945938874224633;
 0.05441560924387312 1.0425389136021639 -0.3462261891158792; 
0.05441560924387312 1.0425389136021639 -0.3462261891158792; 
1.4925910013873618 -0.5867724306928962 -0.05562109888687872; ---> new elements
0.0 0.0 0.0;
 0.0 0.0 0.0;
 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0
0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0
0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0]


t=t2
BM pos = [-1.3882377685265177 1.9171333658946197 2.017726230127882; --> original elements
0.628566885991944 0.9582755795399963 2.871546365138327;
 1.7263898280356287 -2.008754012261011 -1.8643249852530421;
 -1.1711823870216442 1.1122298638704011 -2.4119966013123078; 
1.3127100285520426 0.8872181699272284 1.7643674943291277; 
NaN NaN NaN; ------> elements from t1
 NaN NaN NaN; 
NaN NaN NaN;
 NaN NaN NaN;
 NaN NaN NaN;
 NaN NaN NaN; 
NaN NaN NaN;
 NaN NaN NaN; 
NaN NaN NaN; 
NaN NaN NaN;
 NaN NaN NaN;
 NaN NaN NaN; 
0.1690760297545555 -0.04581032318319567 0.07670062243742004; --> new elements from t2
 -1.279710077774081 1.5146816148825104 -0.19713518559221277; 
1.1774783570137863 -0.5252392163605073 0.5036106899426425;
 1.1774783570137863 -0.5252392163605073 0.5036106899426425;
 0.1690760297545555 -0.04581032318319567 0.07670062243742004; 
0.2776037205069922 -0.44826207419530495 -2.138160793282675;
 1.5195499282938356 -0.5607679211668913 -0.04997874546195724;
 0.2776037205069922 -0.44826207419530495 -2.138160793282675;
 -1.279710077774081 1.5146816148825104 -0.19713518559221277;
 0.07076382076519916 0.9997240168988147 -0.32381455349159005;
 0.07076382076519916 0.9997240168988147 -0.32381455349159005;
 1.5195499282938356 -0.5607679211668913 -0.04997874546195724;
 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0;
0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.0 0.0 0.0]